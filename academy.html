<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ALIKO JB Automotive Academy</title>

  <link rel="icon" href="icon-192.png">
  <link rel="apple-touch-icon" href="icon-192.png">
  <link rel="manifest" href="manifest.json">

  <meta name="theme-color" content="#020617">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #0f172a;
      color: white;
    }

    .app-header {
      display: flex;
      gap: 12px;
      align-items: center;
      padding: 15px;
      background: #020617;
    }

    .app-logo {
      width: 55px;
    }

    .app-nav {
      display: flex;
      justify-content: space-around;
      background: #020617;
      padding: 10px;
    }

    .app-nav a {
      color: #38bdf8;
      text-decoration: none;
      font-weight: bold;
    }

    .content {
      padding: 20px;
    }

    .card {
      background: #020617;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 12px;
    }

    .footer {
      text-align: center;
      padding: 15px;
      font-size: 13px;
      color: #94a3b8;
    }
    .logout-btn {
  background: #020617;
  color: #e5e7eb;
  border: 1px solid #1e293b;
  padding: 10px 18px;
  font-size: 14px;
  font-weight: 500;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.25s ease;
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

.logout-btn:hover {
  background: #020617;
  border-color: #38bdf8;
  color: #38bdf8;
}

.logout-btn:active {
  transform: scale(0.96);
}

.logout-btn i {
  font-size: 15px;
      }
    /* ===============================
   MODERN ACADEMY UI ENHANCEMENT
   =============================== */

/* GLOBAL SMOOTHNESS */
* {
  transition: all 0.25s ease;
}

/* BODY GLOW */
body {
  background: radial-gradient(circle at top, #020617, #000);
}

/* HEADER â€“ GLASS EFFECT */
.app-header {
  backdrop-filter: blur(12px);
  background: rgba(2, 6, 23, 0.85);
  border-bottom: 1px solid rgba(56, 189, 248, 0.15);
}

.app-header h1 {
  font-size: 22px;
  color: #38bdf8;
  letter-spacing: 1px;
}

.app-header p {
  font-size: 13px;
  color: #94a3b8;
}

/* NAVIGATION â€“ APP STYLE */
.app-nav {
  border-top: 1px solid rgba(56, 189, 248, 0.1);
  border-bottom: 1px solid rgba(56, 189, 248, 0.1);
}

.app-nav a {
  padding: 8px 14px;
  border-radius: 20px;
}

.app-nav a:hover {
  background: rgba(56, 189, 248, 0.15);
  color: #7dd3fc;
}

/* SECTION TITLES */
.content h2 {
  font-size: 20px;
  margin-bottom: 16px;
  color: #7dd3fc;
  border-left: 4px solid #38bdf8;
  padding-left: 10px;
}

/* CARDS â€“ GLASS + DEPTH */
.card {
  background: linear-gradient(
    145deg,
    rgba(2, 6, 23, 0.9),
    rgba(15, 23, 42, 0.95)
  );
  border: 1px solid rgba(56, 189, 248, 0.15);
  box-shadow: 0 12px 30px rgba(0, 0, 0, 0.6);
}

.card:hover {
  transform: translateY(-4px) scale(1.01);
  border-color: #38bdf8;
  box-shadow: 0 18px 45px rgba(56, 189, 248, 0.25);
}

.card h3 {
  color: #a5f3fc;
  margin-bottom: 6px;
}

.card p {
  font-size: 14px;
  color: #cbd5f5;
}

/* WHATSAPP BUTTON â€“ PREMIUM CTA */
.btn-academy {
  display: block;
  text-align: center;
  margin-top: 20px;
  padding: 14px;
  background: linear-gradient(135deg, #38bdf8, #0ea5e9);
  color: #020617;
  font-weight: 800;
  border-radius: 16px;
  box-shadow: 0 12px 30px rgba(56, 189, 248, 0.4);
}

.btn-academy:hover {
  transform: scale(1.05);
  box-shadow: 0 18px 40px rgba(56, 189, 248, 0.6);
}

/* LOGOUT BUTTON â€“ FLOATING */
.logout-btn {
  position: fixed;
  bottom: 80px;
  right: 18px;
  background: rgba(2, 6, 23, 0.9);
  border: 1px solid rgba(248, 113, 113, 0.4);
  color: #f87171;
  backdrop-filter: blur(10px);
  box-shadow: 0 12px 35px rgba(0, 0, 0, 0.6);
}

.logout-btn:hover {
  background: rgba(248, 113, 113, 0.15);
  border-color: #f87171;
  color: #fecaca;
}

/* FOOTER */
.footer {
  border-top: 1px solid rgba(56, 189, 248, 0.15);
  background: rgba(2, 6, 23, 0.85);
}

/* MOBILE POLISH */
@media (max-width: 480px) {
  .card {
    margin-bottom: 18px;
  }

  .logout-btn {
    bottom: 70px;
    right: 14px;
  }
  }
    /* ðŸ”¹ COURSE IMAGES CONTROL */
.course-card img,
.card img {
  width: 100%;
  max-height: 220px;       /* kimo cha picha */
  object-fit: cover;       /* inakata bila kupinda */
  border-radius: 10px;
  margin-bottom: 12px;
}

/* ðŸ”¹ COURSE CARD IMPROVEMENT */
.card {
  overflow: hidden;        /* muhimu sana */
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.card:hover {
  transform: translateY(-4px);
  box-shadow: 0 10px 30px rgba(56,189,248,0.15);
  }
    @media (max-width: 600px) {
  .card img {
    max-height: 180px;
  }
    }
  .badge {
  display: inline-block;
  padding: 4px 10px;
  font-size: 11px;
  border-radius: 12px;
  margin-bottom: 8px;
}

.badge.free {
  background: rgba(34,197,94,0.15);
  color: #4ade80;
}

.badge.locked {
  background: rgba(248,113,113,0.15);
  color: #f87171;
  }
    .courses-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.course-card {
  background: #020617;
  border-radius: 14px;
  overflow: hidden;
  box-shadow: 0 10px 30px rgba(0,0,0,0.35);
  transition: transform 0.3s ease;
}

.course-card:hover {
  transform: translateY(-6px);
}

.course-card img {
  width: 100%;
  height: 180px;
  object-fit: cover;
}

.course-content {
  padding: 15px;
}

.course-content h3 {
  margin: 0 0 8px;
  color: #38bdf8;
  font-size: 18px;
}

.course-content p {
  font-size: 14px;
  color: #cbd5f5;
  line-height: 1.5;
}

.course-meta {
  margin-top: 10px;
  font-size: 12px;
  color: #94a3b8;
    }
  </style>

  <link rel="stylesheet" href="style.css">
</head>

<body>
<script>
(function detectUser(){
  const users = JSON.parse(localStorage.getItem("users")) || [];
  const loggedUser = localStorage.getItem("loggedInUser");

  // Kama yuko tayari logged in â†’ Academy
  if(loggedUser){
    if(location.pathname.includes("login")){
      window.location.href = "academy.html";
    }
    return;
  }

  // Kama hakuna users kabisa â†’ Register mode
  if(users.length === 0){
    localStorage.setItem("authMode", "register");
    return;
  }

  // Kama kuna users â†’ Login mode
  localStorage.setItem("authMode", "login");
})();
</script>  
<script>
/* ðŸ” ACADEMY AUTH GUARD - ADDITIVE FIX */
(function () {
  const loggedUser = localStorage.getItem("loggedInUser");
  const users = JSON.parse(localStorage.getItem("users")) || [];

  if (!loggedUser) {
    window.location.href = "login.html";
    return;
  }

  const exists = users.some(u => u.username === loggedUser);

  if (!exists) {
    localStorage.removeItem("loggedInUser");
    window.location.href = "login.html";
  }
})();
</script>
<!-- ðŸ”¹ LOGIN CHECK (MREKEBISHO MUHIMU) -->
<script>
if (
  !localStorage.getItem("loggedInUser") &&
  !sessionStorage.getItem("loggingOut")
) {
  window.location.href = "login.html";
}
</script>

<!-- ðŸ”¹ TOP APP BAR -->
<header class="app-header">
  <img src="icon-192.png" class="app-logo">
  <div>
    <h1>ALIKO JB Academy</h1>
    <p>Automotive Engineering â€¢ Online Training</p>
  </div>
  <script>
const currentUser = localStorage.getItem("loggedInUser");
if(currentUser){
  console.log("Logged user:", currentUser);
}
  </script>
</header>

<!-- ðŸ”¹ NAVIGATION -->
<nav class="app-nav">
  <a href="index.html">ðŸ”§ Workshop</a>
  <a href="#courses">ðŸŽ“ Courses</a>
  <a href="#community">ðŸ’¬ Community</a>
</nav>

<!-- ðŸ”¹ COURSES SECTION -->
<section id="courses" class="content">
  <h2>Online Training Programs</h2>

  <p style="opacity:.6">ðŸ”’ Advanced content coming soon</p>
  <div class="courses-grid" id="coursesContainer">
    <h3>Automotive Electrical Systems</h3>
    <p>CAN Bus, Sensors, ECU, Voltage & Signal analysis.</p>
 <img src="automotive-electrical-systems.jpg" alt="Automotive Electrical Systems Training">
  <span class="badge free">FREE</span>
  </div>

  <div class="courses-grid" id="coursesContainer">
    <h3>Engine & Transmission Control</h3>
    <p>ECU logic, Opticruise, Automatic Gearbox systems.</p>
 <img src="engine-transmission-control.jpg" alt="Engine and Transmission Control Training">
  <span class="badge free">FREE</span>
  </div>

  <div class="courses-grid" id="coursesContainer">
    <h3>Diagnostics & Programming</h3>
    <p>Scanner usage, fault codes, basic programming logic.</p>
  <img src="diagnostics-programming.jpg" alt="Vehicle Diagnostics and Programming Training">
 <span class="badge free">FREE</span>
  </div>
</section>

<!-- ðŸ”¹ COMMUNITY SECTION -->
<section id="community" class="content">
  <h2>Automotive Community & Discussions</h2>

  <div class="card">
    <h3>Ask Questions</h3>
    <p>Fundi na wanafunzi wataweza kuuliza maswali na kubadilishana maarifa ya magari.</p>
  </div>

  <div class="card">
    <h3>Knowledge Sharing</h3>
    <p>Video, diagrams, real vehicle problems & solutions.</p>
  </div>

  <a class="btn-academy" href="https://wa.me/255620198672">ðŸ’¬ Join Discussion (WhatsApp)</a>
</section>
  <!-- LOGOUT -->
<button class="logout-btn" onclick="logout()">
  <i>âŽ‹</i> Logout
</button>
<!-- ðŸ”¹ FOOTER -->
<footer class="footer">
  <p>Â© 2025 ALIKO JB Automotive Engineering</p>
</footer>

<!-- SERVICE WORKER -->
<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("service-worker.js");
}
</script>
  <script>
function logout() {
  // Ondoa user aliye-login
  localStorage.removeItem("loggedInUser");

  // Optional: log kwa debugging
  console.log("User logged out");

  // Rudisha login page
  window.location.href = "login.html";
}
    </script>
<script src="firebase/firebase.js" type="module"></script>
<script src="js/courses.js" type="module"></script>
<script type="module">
  // ðŸ”¹ Firebase SDKs
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
  import { getFirestore, collection, getDocs } 
  from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  // ðŸ”¹ Firebase config (tumia yako)
  const firebaseConfig = {
    apiKey: "AIzaSyAZDwTWKduwhVD9lDNcin_ZCur4kMlWkUA",
    authDomain: "aliko-jb-academy.firebaseapp.com",
    projectId: "aliko-jb-academy",
    storageBucket: "aliko-jb-academy.firebasestorage.app",
    messagingSenderId: "282712708896",
    appId: "1:282712708896:web:c526d620f468a233f82945"
  };

  // ðŸ”¹ Init Firebase
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // ðŸ”¹ Load courses
  const coursesContainer = document.getElementById("coursesContainer");

  async function loadCourses() {
    coursesContainer.innerHTML = "Loading courses...";

    const querySnapshot = await getDocs(collection(db, "courses"));
    coursesContainer.innerHTML = "";

    querySnapshot.forEach((doc) => {
      const course = doc.data();

      if (!course.published) return;

      const card = document.createElement("div");
      card.className = "course-card";

      card.innerHTML = `
        <img src="${course.image}" alt="${course.title}">
        <div class="course-content">
          <h3>${course.title}</h3>
          <p>${course.description}</p>
          <div class="course-meta">
            Level: ${course.level} â€¢ ${course.price === 0 ? "Free" : "Paid"}
          </div>
        </div>
      `;

      coursesContainer.appendChild(card);
    });
  }

  loadCourses();
</script>
</body>
  </html>
